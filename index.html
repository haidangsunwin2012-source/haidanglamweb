<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Hyper Jump - V∆∞·ª£t Ng·ª•c Gai</title>

<style>
body{
    margin:0;
    background:linear-gradient(#050b4d,#02042a);
    color:white;
    text-align:center;
    font-family:Arial, sans-serif;
}
h1{color:#00ffff;text-shadow:0 0 10px cyan;}
h2{color:red;}
#author{font-size:12px;opacity:.8;}
#score{font-size:18px;margin:8px;}

canvas{
    background:black;
    border:3px solid cyan;
    box-shadow:0 0 25px cyan;
    width:98%;
    max-width:1200px;
    height:360px;
}

#jumpBtn{
    margin:20px auto;
    padding:15px 40px;
    font-size:20px;
    border:none;
    border-radius:30px;
    background:cyan;
    box-shadow:0 0 20px cyan;
}

.shake{animation:shake .3s;}
@keyframes shake{
    0%{transform:translate(0)}
    25%{transform:translate(5px)}
    50%{transform:translate(-5px)}
    75%{transform:translate(5px)}
    100%{transform:translate(0)}
}
</style>
</head>

<body>

<h1>HYPER JUMP</h1>
<h2>V∆Ø·ª¢T NG·ª§C GAI</h2>
<div id="author">GAME DO H·∫¢I ƒêƒÇNG T·∫†O</div>
<div id="score">‚≠ê ƒêi·ªÉm: <span id="point">0</span></div>

<canvas id="game" width="1200" height="360"></canvas>
<button id="jumpBtn">‚¨Ü NH·∫¢Y</button>

<audio id="jumpSound" src="https://assets.mixkit.co/active_storage/sfx/2568/2568-preview.mp3"></audio>
<audio id="dieSound" src="https://assets.mixkit.co/active_storage/sfx/2708/2708-preview.mp3"></audio>
<audio id="aduSound" src="https://assets.mixkit.co/active_storage/sfx/2571/2571-preview.mp3"></audio>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

const jumpSound = document.getElementById("jumpSound");
const dieSound = document.getElementById("dieSound");
const aduSound = document.getElementById("aduSound");

const groundY = canvas.height - 60;

/* KH·ª¶NG LONG */
const dinoImg = new Image();
dinoImg.src = "https://i.imgur.com/7yUVEZd.png";
let dino = { x:80, y:groundY-60, w:60, h:60, vy:0 };

/* üåµ GAI */
let spikes = [];

function spawnSpike(){
    let count = Math.random() < 0.3 ? 2 : 1;
    let baseX = canvas.width;
    for(let i=0;i<count;i++){
        spikes.push({
            x: baseX + i*35,
            w:18,
            h:5
        });
    }
}

let gravity = 1;
let jumping = false;

/* üöÄ T·ªêC ƒê·ªò X2 */
let speed = 20; // üî• tr∆∞·ªõc l√† 10

let score = 0;
let gameOver = false;

/* √ÇM THANH */
let audioUnlocked=false;
function unlockAudio(){
    if(audioUnlocked) return;
    [jumpSound,dieSound,aduSound].forEach(a=>{
        a.volume=0;
        a.play().then(()=>{
            a.pause();
            a.currentTime=0;
            a.volume=1;
        });
    });
    audioUnlocked=true;
}

function update(){
    if(gameOver) return;
    ctx.clearRect(0,0,canvas.width,canvas.height);

    dino.y+=dino.vy;
    dino.vy+=gravity;
    if(dino.y>=groundY-dino.h){
        dino.y=groundY-dino.h;
        dino.vy=0;
        jumping=false;
    }

    if(spikes.length===0){
        spawnSpike();
    }

    for(let i=spikes.length-1;i>=0;i--){
        let s = spikes[i];
        s.x -= speed;

        if(
            dino.x < s.x + s.w &&
            dino.x + dino.w > s.x &&
            dino.y + dino.h > groundY - s.h
        ){
            gameOver=true;
            dieSound.play();
            canvas.classList.add("shake");
        }

        if(s.x < -s.w){
            spikes.splice(i,1);
            score++;
            point.innerText = score;
            if(score % 3 === 0){
                aduSound.currentTime = 0;
                aduSound.play();
            }
        }
    }

    ctx.fillStyle="#222";
    ctx.fillRect(0,groundY,canvas.width,4);
    ctx.drawImage(dinoImg,dino.x,dino.y,dino.w,dino.h);

    ctx.fillStyle="red";
    spikes.forEach(s=>{
        ctx.fillRect(s.x, groundY-6, s.w, s.h);
    });

    requestAnimationFrame(update);
}

function jump(){
    unlockAudio();
    if(!jumping && !gameOver){
        dino.vy=-17;
        jumping=true;
        jumpSound.currentTime=0;
        jumpSound.play();
    }
}

jumpBtn.onclick=jump;
document.addEventListener("keydown",e=>{
    if(e.code==="Space") jump();
});

dinoImg.onload=update;
</script>

</body>
</html>
